<div class="home-wrapper">
  
  {{> sidebar}}
  {{> messages}}
  <!-- Main Author Content -->
  <div class="home-main">
    <!-- Author Header -->
    <div class="profile-header">
      <div class="header-left">
        <h1 class="profile-title">User Profile</h1>
      </div>
    </div>

    <!-- Author Profile Content -->
    <div class="profile-form-container">
      <div class="profile-content-grid">
        <!-- Left Column -->
        <div class="profile-left-section">
          <!-- Profile Photo Section -->
          <div class="profile-photo-card">
            <div class="photo-gradient-container">
              <div class="gradient-background" style="background: {{#if author.backgroundColor}}{{author.backgroundColor}}{{else}}linear-gradient(135deg, #E879F9 0%, #8B5CF6 25%, #06B6D4 50%, #10B981 75%, #F59E0B 100%){{/if}};">
              </div>
              <div class="profile-avatar-container">
                <img src="{{defaultAvatar author.avatar}}" alt="Profile Avatar" class="profile-avatar-img">
              </div>
            </div>
            <div class="photo-section-content">
              <h3 class="photo-title">Profile Photo</h3>
              <p class="photo-description">{{author.name}}'s profile picture</p>
            </div>
          </div>

          <!-- Personal Information Section -->
          <div class="personal-info-card">
            <h3 class="section-title">Personal Information</h3>
            
            <div class="info-field">
              <label class="field-label">Full Name</label>
              <div class="info-value">
                <i class="fas fa-user info-icon"></i>
                <span>{{author.name}}</span>
              </div>
            </div>

            <div class="info-field">
              <label class="field-label">Email Address</label>
              <div class="info-value">
                <i class="fas fa-envelope info-icon"></i>
                <span>{{#if user.email}}{{author.email}}{{else}}Not provided{{/if}}</span>
              </div>
            </div>

            <div class="info-field">
              <label class="field-label">Role</label>
              <div class="info-value">
                <i class="fas fa-briefcase info-icon"></i>
                <span>{{#if user.role}}{{author.role}}{{else}}Not specified{{/if}}</span>
              </div>
            </div>

            <div class="info-field">
              <label class="field-label">Member Since</label>
              <div class="info-value">
                <i class="fas fa-calendar info-icon"></i>
                <span>{{formatDate user.createdAt}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column -->
        <div class="profile-right-section">
          <!-- Bio Section -->
          <div class="bio-card">
            <h3 class="section-title">Bio</h3>
            <div class="bio-content">
              {{#if user.bio}}
                <p>{{author.bio}}</p>
              {{else}}
                <p class="no-bio">This user hasn't added a bio yet.</p>
              {{/if}}
            </div>
          </div>

          <!-- Platform Statistics Section -->
          <div class="author-stats-card">
            <h3 class="section-title">Platform Performance</h3>
            <div class="stats-grid">
              <div class="stat-item">
                <i class="fas fa-eye stat-icon"></i>
                <div class="stat-info">
                  <span class="stat-number">{{formatNumber stats.totalViews}}</span>
                  <span class="stat-label">Total Views</span>
                </div>
              </div>
              <div class="stat-item">
                <i class="fas fa-heart stat-icon"></i>
                <div class="stat-info">
                  <span class="stat-number">{{formatNumber stats.totalFavorites}}</span>
                  <span class="stat-label">Total Favorites</span>
                </div>
              </div>
              <div class="stat-item">
                <i class="fas fa-lightbulb stat-icon"></i>
                <div class="stat-info">
                  <span class="stat-number">{{formatNumber stats.ideasCount}}</span>
                  <span class="stat-label">Ideas Published</span>
                </div>
              </div>
              <div class="stat-item">
                <i class="fas fa-calendar stat-icon"></i>
                <div class="stat-info">
                  <span class="stat-number">{{formatDate user.createdAt "MMM YYYY"}}</span>
                  <span class="stat-label">Joined</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Top Ideas Section -->
          <div class="top-ideas-card">
            <h3 class="section-title">Featured Works</h3>
            {{#if topIdeas.length}}
              <div class="top-ideas-list">
                {{#each topIdeas}}
                  <div class="top-idea-item" data-share-link="{{shareLink}}">
                    <div class="idea-content">
                      <h4 class="idea-title">{{truncatedTitle}}</h4>
                      <p class="idea-description">{{truncatedContent}}</p>
                    </div>
                    <div class="idea-meta">
                      <span class="ranking-badge rank-{{add @index 1}}">
                        <i class="fas fa-trophy"></i>
                        Top {{add @index 1}}
                      </span>
                      <span class="idea-date">{{formatDate createdAt "MMM DD"}}</span>
                    </div>
                  </div>
                {{/each}}
              </div>
            {{else}}
              <div class="no-ideas-message">
                {{#if user.isCurrentUser}}
                  <p>You haven't published any ideas yet. <a href="/ideas/new">Create your first idea!</a></p>
                {{else}}
                  <p>This user hasn't published any public ideas yet.</p>
                {{/if}}
              </div>
            {{/if}}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>

.header-left {
  display: flex;
  align-items: center;
}

.info-field {
  margin-bottom: 1.5rem;
}

.info-value {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0.75rem;
  background: #f8f9fa;
  border-radius: 6px;
  border: 1px solid #e9ecef;
  margin-top: 0.5rem;
  color: #374151;
}

.dark-mode .info-value {
  background: #2d3748;
  border-color: #4a5568;
  color: #e2e8f0;
}

.info-icon {
  color: #6b7280;
  font-size: 0.9rem;
}

.dark-mode .info-icon {
  color: #9ca3af;
}

.bio-content {
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 6px;
  border: 1px solid #e9ecef;
  min-height: 100px;
  color: #374151;
}

.dark-mode .bio-content {
  background: #2d3748;
  border-color: #4a5568;
  color: #e2e8f0;
}

.no-bio {
  color: #6b7280;
  font-style: italic;
}

.dark-mode .no-bio {
  color: #9ca3af;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {

  // Handle top idea item clicks
  const topIdeaItems = document.querySelectorAll('.top-idea-item[data-share-link]');
  topIdeaItems.forEach(item => {
    item.addEventListener('click', function() {
      const shareLink = this.dataset.shareLink;
      if (shareLink && shareLink !== '' && shareLink !== 'undefined') {
        // Navigate to explore page with share parameter
        window.location.href = `/explore?share=${shareLink}`;
      } else {
        console.warn('Invalid share link for navigation:', shareLink);
      }
    });
  });
});
</script>